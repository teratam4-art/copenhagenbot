# 🤖 나만의 주식 도우미 (AI 수급 분석 트레이더)

> 외국인·기관이 언제 사고파는지 알려주고, 지금이 "흔들기(물량 털기)"인지 "진짜 하락"인지 구분해주는 주식 판단 도우미

---

## 📋 목차

1. [프로그램 개요](#프로그램-개요)
2. [주요 기능](#주요-기능)
3. [설치 방법](#설치-방법)
4. [사용법](#사용법)
5. [패턴 설명](#패턴-설명)
6. [출력 예시](#출력-예시)
7. [파일 구조](#파일-구조)
8. [주의사항](#주의사항)

---

## 🎯 프로그램 개요

이 프로그램은 **외국인과 기관의 매매 패턴**을 분석하여:

- ✅ **물량 털기** vs **진짜 이탈**을 자동으로 판단
- ✅ **1차·2차 매수 타이밍** 제시
- ✅ **익절가·손절가** 자동 계산
- ✅ **과열 구간** 알림

한국 주식(종목번호)과 미국 주식(티커) 모두 지원합니다.

---

## ✨ 주요 기능

### 1️⃣ 외국인/기관 매매 패턴 분석

- 최근 5일 평균 매매 흐름 확인
- 외국인과 기관의 매수/매도 동향 파악
- 거래량 추세 분석

### 2️⃣ 물량 털기 vs 진짜 이탈 판단

| 패턴 | 조건 | 의미 |
|------|------|------|
| 🟡 **물량 털기** | 외국인 매도 + 기관 매수 + 거래량 유지 + 가격이 MA20 위 | 단기 조정 후 상승 가능성 높음 |
| 🟢 **상승 신호** | 외국인 매수 + 기관 매수 | 시장이 진짜 좋아졌다는 신호 |
| 🔴 **진짜 이탈** | 외국인 매도 + 기관도 매도 + 거래량 감소 | 하락 전환 가능성 높음 |
| ⚪ **불명확** | 명확한 패턴 없음 | 추가 관찰 필요 |

### 3️⃣ 매수/매도 타이밍 제시

- **1차 매수**: MA5 근처 눌림 구간
- **2차 매수**: MA20 근처 눌림 구간
- **1차 익절**: 매수가 대비 5-8% (패턴에 따라 조정)
- **2차 익절**: 매수가 대비 12-15% (패턴에 따라 조정)
- **손절가**: MA20 이탈 시 또는 3% 하락

### 4️⃣ 기술적 지표 분석

- **RSI**: 과열/과매도 구간 판단
- **이동평균선**: MA5, MA20, MA60
- **가격 대비 20일선**: 상승/하락 추세 확인

---

## 📦 설치 방법

### 1. 필수 패키지 설치

```bash
pip install -r requirements_trader.txt
```

### 2. 필요한 패키지 목록

- `pandas` - 데이터 처리
- `requests` - 웹 크롤링
- `beautifulsoup4` - HTML 파싱
- `yfinance` - 미국 주식 데이터
- `numpy` - 수치 계산
- `lxml` - HTML 파싱

### 3. 파일 확인

다음 파일들이 같은 디렉토리에 있어야 합니다:

- `main_trader.py` - 메인 실행 파일
- `data_fetcher.py` - 데이터 수집 모듈
- `pattern_detector.py` - 패턴 분석 모듈
- `signal_generator.py` - 신호 생성 모듈
- `risk_manager.py` - 리스크 관리 모듈
- `stock_screener.py` - 기존 스크리너 (데이터 수집용)

---

## 💻 사용법

### 기본 명령어

```bash
# 한국 주식 분석 (종목번호 6자리)
python main_trader.py --code 035720

# 미국 주식 분석 (티커)
python main_trader.py --code AAPL
```

### 한국 주식 예시

```bash
# 카카오
python main_trader.py --code 035720

# 삼성전자
python main_trader.py --code 005930

# SK하이닉스
python main_trader.py --code 000660
```

### 미국 주식 예시

```bash
# 애플
python main_trader.py --code AAPL

# 테슬라
python main_trader.py --code TSLA

# 엔비디아
python main_trader.py --code NVDA
```

---

## 📊 패턴 설명

### 🟡 물량 털기 (Shakeout)

**조건:**
- 외국인이 매도 중
- 기관이 매수 중
- 거래량이 유지되거나 증가
- 가격이 20일선 위에 있음

**의미:**
- 단기 조정 후 상승 가능성이 높음
- 외국인이 물량을 내주는 동안 기관이 받아가고 있음
- 거래량이 유지되면 진짜 매도가 아님

**전략:**
- 눌림 구간에서 매수 추천
- 1차: MA5 근처
- 2차: MA20 근처

---

### 🟢 상승 신호 (Bullish Signal)

**조건:**
- 외국인이 매수 중
- 기관도 매수 중

**의미:**
- 시장이 진짜 좋아졌다는 신호
- 큰 손들이 동시에 매수하고 있음

**전략:**
- 적극 매수 추천
- 현재가 근처 또는 약간 아래에서 매수
- 공격적 익절 (5-8%, 12-15%)

---

### 🔴 진짜 이탈 (Real Exit)

**조건:**
- 외국인이 매도 중
- 기관도 매도 중
- 거래량이 감소

**의미:**
- 하락 전환 가능성이 높음
- 큰 손들이 모두 빠져나가고 있음

**전략:**
- 매수 비추천
- 관망 권장
- 보유 중이면 빠른 익절 고려

---

### ⚪ 불명확 (Unclear)

**조건:**
- 명확한 패턴이 감지되지 않음
- 외국인/기관 데이터 없음 (미국 주식 등)

**의미:**
- 추가 관찰이 필요함

**전략:**
- 보수적 접근 권장
- 기술적 지표만으로 판단
- MA20 근처에서 보수적 매수

---

## 📈 출력 예시

### 한국 주식 분석 결과

```
======================================================================
🤖 나만의 주식 도우미 (AI 수급 분석 트레이더)
======================================================================

📥 데이터 수집 중... (한국 주식)

======================================================================
📊 카카오 (035720) 분석 결과
======================================================================

[현재 상황]
현재가: 60,700원
외국인: 📉 매도 (최근 5일 평균: -12,345주)
기관: 📈 매수 (최근 5일 평균: +8,901주)
거래량 추세: 유지

패턴 판단: 🟡 물량_털기 (신뢰도: 75%)
→ 외국인 매도 중이지만 기관이 매수하고 있고, 거래량이 유지하며 
  가격이 20일선 위에 있어 물량 털기 가능성이 높습니다.

RSI: 58.3 (강세)
20일선 대비: +2.1%

======================================================================
[추천 전략]
======================================================================

💰 1차 매수: 59,000원
   예상 도달: 약 3일 후
   이유: MA5 근처 눌림 구간 (1차 매수)

💰 2차 매수: 57,500원
   예상 도달: 약 5일 후
   이유: MA20 근처 눌림 구간 (2차 매수)

💡 전략: 물량 털기 패턴: 단기 조정 후 상승 가능성이 높으므로 
        눌림 구간에서 매수 추천

📈 1차 익절: 62,000원
📈 2차 익절: 64,000원
   이유: 상승 패턴이므로 공격적 익절 추천

🛑 손절가: 56,000원
   손실률: -3.0%
   이유: MA20 이탈 시 손절 (3% 하락)

======================================================================
[요약]
======================================================================

🟡 단기 조정 후 상승 가능성 75%
```

### 미국 주식 분석 결과

```
======================================================================
🤖 나만의 주식 도우미 (AI 수급 분석 트레이더)
======================================================================

📥 데이터 수집 중... (미국 주식)

======================================================================
📊 Apple Inc. (AAPL) 분석 결과
======================================================================

[현재 상황]
현재가: $175.50

패턴 판단: ⚪ 불명확 (신뢰도: 0%)
→ 외국인/기관 매매 데이터 없음

RSI: 62.5 (강세)
20일선 대비: +3.2%

======================================================================
[추천 전략]
======================================================================

💰 1차 매수: $172.00
   예상 도달: 약 2일 후
   이유: MA20 근처 보수적 매수 (1차)

💰 2차 매수: $168.50
   예상 도달: 약 5일 후
   이유: MA20 아래 보수적 매수 (2차)

💡 전략: 불명확한 패턴: 보수적 접근 권장

📈 1차 익절: $180.60
📈 2차 익절: $189.20
   이유: 불명확한 패턴이므로 보수적 익절 추천

🛑 손절가: $166.80
   손실률: -3.0%
   이유: 보수적 손절 (3% 하락 또는 MA20 이탈)

======================================================================
[요약]
======================================================================

⚪ 추가 관찰 필요
```

---

## 📁 파일 구조

```
주식투자_혜인/
├── main_trader.py              # 메인 실행 파일
├── data_fetcher.py             # 데이터 수집 모듈
├── pattern_detector.py         # 패턴 분석 모듈
├── signal_generator.py         # 신호 생성 모듈
├── risk_manager.py             # 리스크 관리 모듈
├── stock_screener.py           # 기존 스크리너 (데이터 수집용)
├── requirements_trader.txt     # 필수 패키지 목록
└── 나만의_주식도우미_노션가이드.md  # 이 문서
```

### 각 파일 역할

| 파일 | 역할 |
|------|------|
| `main_trader.py` | 프로그램 진입점, 전체 분석 흐름 제어 |
| `data_fetcher.py` | 주식 데이터, 외국인/기관 매매 데이터 수집 |
| `pattern_detector.py` | 물량 털기 vs 진짜 이탈 판단 로직 |
| `signal_generator.py` | 매수/매도 타이밍 계산 |
| `risk_manager.py` | 손절가/익절가 계산, 과열 구간 판단 |

---

## ⚠️ 주의사항

### 1. 참고용 도구

이 프로그램은 **투자 참고용 도구**입니다. 실제 투자 결정은 본인의 판단과 책임 하에 이루어져야 합니다.

### 2. 데이터 제한사항

- **외국인/기관 매매 데이터**: 한국 주식에만 제공됩니다.
- **미국 주식**: 외국인/기관 데이터가 없어 패턴 판단이 제한적일 수 있습니다.
- **데이터 수집 실패**: 네이버 증권 페이지 구조 변경 시 일부 기능이 작동하지 않을 수 있습니다.

### 3. 네트워크 요구사항

- 인터넷 연결 필요
- 네이버 증권, 야후 파이낸스 접근 가능해야 함

### 4. 종목 코드 형식

- **한국 주식**: 6자리 숫자 (예: `035720`, `005930`)
- **미국 주식**: 티커 심볼 (예: `AAPL`, `TSLA`, `NVDA`)

---

## 🔧 문제 해결

### 데이터 수집 실패 시

1. **네트워크 연결 확인**
   ```bash
   ping finance.naver.com
   ```

2. **종목 코드 확인**
   - 한국 주식: 6자리 숫자인지 확인
   - 미국 주식: 티커가 올바른지 확인

3. **필수 파일 확인**
   - `stock_screener.py` 파일이 같은 디렉토리에 있는지 확인

### 외국인/기관 데이터가 없을 때

- 한국 주식인지 확인
- 네이버 증권에서 해당 종목의 외국인/기관 매매 페이지가 있는지 확인
- 데이터가 없어도 기술적 지표 기반으로 분석 가능

### 패키지 설치 오류

```bash
# 개별 설치
pip install pandas requests beautifulsoup4 yfinance numpy lxml

# 또는
pip install -r requirements_trader.txt
```

---

## 💡 활용 팁

### 1. 여러 종목 비교

```bash
# 종목 A
python main_trader.py --code 035720 > result1.txt

# 종목 B
python main_trader.py --code 005930 > result2.txt

# 결과 비교
diff result1.txt result2.txt
```

### 2. 정기적 모니터링

스크립트를 만들어 정기적으로 실행:

```bash
#!/bin/bash
# monitor.sh
python main_trader.py --code 035720
python main_trader.py --code 005930
python main_trader.py --code 000660
```

### 3. 결과 저장

```bash
python main_trader.py --code 035720 > analysis_$(date +%Y%m%d).txt
```

---

## 📞 추가 정보

### 관련 파일

- `stock_scanner.py` - 단기/스윙용 종목 탐색기
- `stock_screener.py` - 주식 스크리닝 도구
- `kosdaq_golden_buy.py` - 골든 크로스 분석

### 업데이트 이력

- **v1.0** (2024): 초기 버전
  - 외국인/기관 매매 패턴 분석
  - 물량 털기 vs 진짜 이탈 판단
  - 매수/매도 타이밍 제시

---

## 🎓 학습 자료

### 용어 설명

- **물량 털기**: 큰 손들이 의도적으로 가격을 내려 개인 투자자들을 겁주고 물량을 빼앗는 행위
- **진짜 이탈**: 큰 손들이 진짜로 빠져나가면서 가격이 하락하는 상황
- **MA5/MA20/MA60**: 5일/20일/60일 이동평균선
- **RSI**: 상대강도지수 (70 이상: 과열, 30 이하: 과매도)

### 참고 자료

- 네이버 증권: https://finance.naver.com
- 야후 파이낸스: https://finance.yahoo.com

---

**마지막 업데이트**: 2024년

**버전**: 1.0

---

> 💡 **Tip**: 이 도구는 보조 도구입니다. 항상 본인의 판단과 리스크 관리가 중요합니다!

