# 📘 눌림목 스크리너(Notion용 가이드)

## 1. 개요
- 파일: `dip_screener.py`
- 목적: 한국(KOSPI/KOSDAQ)과 미국(NYSE/NASDAQ) 시장에서 **상승 추세 안의 단기 눌림목** 종목을 자동으로 찾아 리스트로 보여줍니다.
- 데이터: `yfinance` 기반 일봉 데이터 (거래량/가격 조정 없음). 네트워크 연결이 필요합니다.

## 2. 준비 사항
- Python 3.9 이상 권장
- 필수 패키지:
  - `pandas`
  - `numpy`
  - `yfinance`
- 설치 명령 예시:
  ```bash
  pip install pandas numpy yfinance
  ```

## 3. 실행 방법
```bash
cd /Users/sinhyein/Documents/주식투자_혜인
python dip_screener.py
```
- 기본 실행만으로 한국/미국 시장에 대한 눌림목 후보 표가 차례대로 출력됩니다.
- 네트워크가 차단된 환경에서는 결과가 비어 나올 수 있으니 인터넷 연결을 확인하세요.

## 4. 주요 설정값 (스크립트 상단 변수)
| 변수 | 설명 | 기본값 |
| --- | --- | --- |
| `LOOKBACK_DAYS` | 조회하는 최소 거래일 수 | 160 |
| `RSI_WINDOW` | RSI 계산 기간 | 14 |
| `KR_MIN_AVG_TRADE_VALUE` | 한국 종목 20일 평균 거래대금 하한 (원) | 1,000,000,000 |
| `KR_RSI_RANGE` | 한국 RSI 허용 범위 | (40, 55) |
| `KR_RECENT_CANDLE_WINDOW` | 최근 음봉 체크 기간 | 3 일 |
| `KR_MIN_NEGATIVE_CANDLES` | 기간 내 최소 음봉 개수 | 2 개 |
| `US_RECENT_RETURN_WINDOW` | 미국 종목 최근 수익률 체크 기간 | 5 일 |
| `US_RECENT_RETURN_THRESHOLD` | 해당 기간 수익률 하한 | -3% |
| `US_RSI_RANGE` | 미국 RSI 허용 범위 | (35, 55) |
| `US_VOLUME_RATIO_RANGE` | 오늘 거래량 / 20일 평균 거래량 허용 범위 | (0.8, 1.5) |
| `KR_UNIVERSE_LIMIT` | 한국 종목 스캔 최대 개수 | 200 |
| `US_UNIVERSE_LIMIT` | 미국 종목 스캔 최대 개수 | 300 |

> 필요에 따라 원하는 숫자로 수정 후 실행하면 됩니다.

## 5. 출력 예시 & 해석

### 5.1 한국 시장 섹션
```
================================================================================
🇰🇷 한국 KOSPI/KOSDAQ 눌림목 후보
================================================================================
Ticker   Name      Close    MA5   MA20    MA60   RSI  오늘등락(%)  MA20乂(%) Comment                                평균거래대금(20일)
005930.KS 삼성전자    75,300 74,800 75,100 72,900 45.2        -0.84     -0.27 MA5 이탈 / MA20 근접 / RSI 40~55 / 중기 추세 유지    1,500,000,000,000
...
```
- **정렬 기준**: MA20과의 괴리율이 작은 순 → RSI가 45에 근접한 순 → 거래대금이 큰 순.
- `Comment` 컬럼에 눌림목 판정 사유를 한글로 제공하여 초보자도 이해하기 쉽게 작성했습니다.
- 마지막 줄에 “이건 눌림목 후보일 뿐 매수 보장은 아닙니다.” 경고 문구가 함께 출력됩니다.

### 5.2 미국 시장 섹션
```
================================================================================
🇺🇸 미국 (NYSE/NASDAQ) dip 후보
================================================================================
Ticker Name  Close    MA5   MA20   MA60   RSI 오늘등락(%) MA20乂(%) Comment                              VolumeRatio
AAPL   Apple 178.45 177.6 180.1 173.5 41.3       -1.20     -0.92 MA5 하향 이탈 / 최근 5일 약세 / RSI 35~55 / 중기 추세 유지 0.95
...
```
- `VolumeRatio`가 0.8~1.5 사이면 “거래량 평소 대비 적정”, 임계값보다 높으면 “거래량 급증 주의”가 코멘트에 추가됩니다.
- 마지막 줄에는 “이건 기술적 눌림 스크리닝 결과이며, 실적/뉴스 리스크는 별도로 확인하세요.” 경고 문구가 출력됩니다.

### 5.3 데이터 부족 안내
- `yfinance`에서 데이터를 가져오지 못한 종목은 자동으로 건너뛰며, 출력 하단에
  - `⚠️ 한국: 데이터 부족으로 제외된 종목 ...`
  - `⚠️ 미국: 데이터 부족으로 제외된 종목 ...`
  형식으로 정리됩니다.

## 6. 활용 팁
- **변수 커스터마이즈**: 상단 파라미터를 조정해 RSI 범위, 거래량 조건, 조회 기간 등을 자유롭게 설정하세요.
- **대상 종목 확장**: `stock_screener.get_top_korean_stocks`, `get_top_us_stocks` 함수가 존재하면 자동으로 시총 상위 종목을 불러옵니다. 함수가 없거나 실패하면 스크립트 내부의 기본 티커 목록을 사용합니다.
- **정렬 로직 수정**: “가장 매매하기 좋아 보이는 순서”를 바꾸고 싶다면 `screen_korean_market`, `screen_us_market` 함수 마지막의 `results.sort(...)` 조건을 수정하면 됩니다.
- **다른 출력 형태**: 현재 콘솔 표 출력 위주로 구성되어 있으며, 필요하다면 `build_dataframe` 함수 결과(DataFrame)를 CSV로 저장하거나 노션 API에 연결하여 활용할 수 있습니다.

## 7. 주의 사항
- `yfinance`는 무료 데이터이므로 서버 상태나 네트워크 환경에 따라 일시적 오류가 발생할 수 있습니다.
- 실제 매수 전에는 **기업 실적, 공시, 뉴스** 등 펀더멘털 요인과 개인 투자 성향을 반드시 확인하세요.
- 본 스크리너는 학습용 참고 도구이며, 투자 손익에 대한 책임은 본인에게 있습니다.

---

**문의/피드백**: 스크립트 실행 중 오류가 발생하거나 지표 조건을 확장하고 싶으면 언제든지 질문하세요! ✉️


