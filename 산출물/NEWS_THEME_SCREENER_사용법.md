# 📰 뉴스 기반 테마 주식 스크리닝 시스템 사용법

## 🎯 개요

이 시스템은 뉴스를 분석하여 테마 주식을 자동으로 찾아주고, 기술적 신호와 결합하여 매수 타이밍을 추천합니다.

### 주요 기능

1. **뉴스 감지 및 테마 스코어링**
   - 키워드 공동출현 빈도 계산
   - 긍정/부정 감정 분석
   - 테마별 점수 집계

2. **자동 산업 매핑**
   - 테마별 관련 종목 자동 연결
   - 한국/미국 주식 모두 지원

3. **뉴스 반응 지연 패턴 학습**
   - SQLite 데이터베이스에 뉴스 이벤트 저장
   - 주가 반응 패턴 분석

4. **기술적 신호와 결합**
   - 기존 `stock_screener.py`와 연동
   - 뉴스 테마 + 기술적 진입 신호 교집합

5. **주간 테마 리포트**
   - 지난 7일간 뉴스 분석
   - Top 5 테마 및 추천 종목

## 📋 설치

```bash
pip install yfinance pandas beautifulsoup4 requests pytz
```

## 🚀 사용법

### 1. 기본 뉴스 테마 스크리닝

```bash
# 한국 뉴스만
python3 news_theme_screener.py --market korea

# 미국 뉴스만
python3 news_theme_screener.py --market us

# 한국 + 미국 모두
python3 news_theme_screener.py --market both
```

### 2. 최소 점수 조정

```bash
# 점수 3.0 이상인 테마만 표시
python3 news_theme_screener.py --market korea --min-score 3.0

# 점수 2.0 이상인 테마만 표시 (더 많은 테마)
python3 news_theme_screener.py --market korea --min-score 2.0
```

### 3. 뉴스 + 기술적 신호 결합 (추천)

```bash
# 뉴스 테마와 기술적 진입 신호가 동시에 있는 종목만 추천
python3 news_theme_screener.py --combine-technical --market korea

# RSI 범위 조정
python3 news_theme_screener.py --combine-technical --rsi-min 45 --rsi-max 60

# 거래량 조건 조정
python3 news_theme_screener.py --combine-technical --volume-min 1.2
```

### 4. 주간 리포트 생성

```bash
# 지난 7일간 뉴스 분석 후 리포트 생성
python3 news_theme_screener.py --weekly-report
```

리포트는 `weekly_theme_report.md` 파일로 저장됩니다.

## 📊 출력 예시

### 기본 테마 스크리닝 결과

```
============================================================
📰 뉴스 기반 테마 주식 스크리닝
============================================================

1️⃣ 뉴스 크롤링 중...
   한국 뉴스: 37건

2️⃣ 테마 스코어링 중...
   계산된 테마 점수:
     반도체: 2.40점 (2건)
     AI: 2.12점 (2건)

3️⃣ 상위 테마 선정 (점수 2.0 이상):
   반도체 ➡️ +2.4 (2건, 감정: neutral)
   AI ➡️ +2.1 (2건, 감정: neutral)

4️⃣ 종목 매핑 중...
   반도체: 5개 종목
   AI: 4개 종목

============================================================
📋 테마별 종목 리스트
============================================================

반도체 (점수: 2.4)
  종목: 000660, 000990, 006400, 005930, 035720

AI (점수: 2.1)
  종목: 000990, 005930, 000660, 035720
```

### 뉴스 + 기술적 신호 결합 결과

```
============================================================
🔗 뉴스 테마 + 기술적 신호 결합
============================================================

📊 반도체 테마 분석 중...
   ✅ 000660: 뉴스 테마 + 기술적 신호 일치
   ✅ 005930: 뉴스 테마 + 기술적 신호 일치

============================================================
🎯 최종 추천 종목 (뉴스 테마 + 기술적 신호)
============================================================

📈 000660 (반도체)
   테마 점수: 2.4
   현재가: 120,000원
   판단: ✅ 진입 가능 (종가 기준)
```

## 🎨 테마 종류

현재 지원하는 테마:

- **신재생에너지**: 태양광, 풍력, 탄소중립, ESG
- **반도체**: 메모리, D램, 낸드, 파운드리, HBM
- **AI**: 인공지능, 머신러닝, GPT, 생성AI
- **EV**: 전기차, 배터리, 리튬, 충전
- **방산**: 국방, 무기, 미사일, 방산수출
- **바이오**: 신약, 임상, FDA, 바이오텍
- **2차전지**: 양극재, 음극재, 전해액

## ⚙️ 고급 옵션

### 뉴스 크롤링 개선

현재는 네이버 뉴스와 Yahoo Finance를 사용하지만, 다음을 추가할 수 있습니다:

- OpenAI API를 사용한 본문 요약 및 핵심 키워드 추출
- HuggingFace 모델을 사용한 감정 분석 고도화
- 더 많은 뉴스 소스 추가 (네이버 증권, 다음 뉴스 등)

### 산업 매핑 자동화

현재는 수동으로 종목을 매핑하지만, 다음을 추가할 수 있습니다:

- OpenDART API로 실제 업종 태그 자동 매핑
- KRX 산업 분류 API 활용
- 시가총액/유동성 기준 상위 종목 자동 갱신

### 뉴스 반응 지연 패턴

`NewsReactionTracker` 클래스를 사용하여:

```python
tracker = NewsReactionTracker()
tracker.record_news_event('반도체', datetime.now(), 5.0, 'positive', '뉴스 제목')
# 주가 반응 추적 후
pattern = tracker.calculate_reaction_pattern('반도체')
# {'avg_delay': 2.4, 'avg_return': 3.2, 'sample_count': 20}
```

## 🔔 알림 시스템 (향후 추가)

Slack/텔레그램 알림을 추가하려면:

```python
# Slack Webhook 예시
def send_slack_notification(message):
    webhook_url = "YOUR_SLACK_WEBHOOK_URL"
    requests.post(webhook_url, json={'text': message})
```

## 📝 주의사항

1. **뉴스 크롤링**: 네이버 뉴스 구조가 변경되면 크롤링이 실패할 수 있습니다. 이 경우 샘플 데이터가 사용됩니다.

2. **API 제한**: Yahoo Finance API는 요청 제한이 있을 수 있습니다. 대량 종목 분석 시 시간 간격을 두세요.

3. **데이터 정확도**: 뉴스 기반 분석은 참고용이며, 실제 투자 결정은 추가 검토가 필요합니다.

## 🔧 문제 해결

### 뉴스 크롤링 실패

```
⚠️  뉴스 크롤링 실패, 샘플 데이터 사용
```

→ 네이버 뉴스 구조가 변경되었을 수 있습니다. `fetch_korean_news()` 함수를 수정하세요.

### 테마 점수가 너무 낮음

```
❌ 분석할 테마가 없습니다.
```

→ `--min-score` 값을 낮추세요 (예: `--min-score 1.0`)

### stock_screener 모듈 오류

```
⚠️  stock_screener 모듈을 찾을 수 없습니다.
```

→ `stock_screener.py` 파일이 같은 디렉토리에 있는지 확인하세요.

## 📚 관련 파일

- `news_theme_screener.py`: 메인 스크립트
- `stock_screener.py`: 기술적 신호 분석 (연동)
- `news_reaction.db`: 뉴스 반응 패턴 데이터베이스 (자동 생성)
- `weekly_theme_report.md`: 주간 리포트 (자동 생성)

## 💡 향후 개선 사항

1. ✅ 뉴스 감지 및 테마 스코어링
2. ✅ 자동 산업 매핑
3. ✅ 뉴스 반응 지연 패턴 학습
4. ✅ 기술적 신호와 결합
5. ✅ 주간 리포트 생성
6. ⏳ 트리거 기반 알림 (Slack/텔레그램)
7. ⏳ OpenAI API 통합 (본문 요약)
8. ⏳ 더 많은 테마 추가
9. ⏳ ETF 추적 기능
10. ⏳ 구글 트렌드 연동

